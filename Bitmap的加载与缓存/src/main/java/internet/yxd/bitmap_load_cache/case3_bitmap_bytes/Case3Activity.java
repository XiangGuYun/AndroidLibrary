package internet.yxd.bitmap_load_cache.case3_bitmap_bytes;

import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.util.Log;
import android.widget.ImageView;

import com.google.gson.Gson;

import java.io.ByteArrayOutputStream;
import java.util.ArrayList;
import java.util.List;

import internet.yxd.bitmap_load_cache.R;
import internet.yxd.bitmap_load_cache.case1_compress_bitmp.BitmapUtils;

public class Case3Activity extends AppCompatActivity {

    String test = "[-1,-40,-1,-32,0,16,74,70,73,70,0,1,1,0,0,1,0,1,0,0,-1,-37,0,67,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-37,0,67,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-64,0,17,8,0,35,0,35,3,1,34,0,2,17,1,3,17,1,-1,-60,0,31,0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,-1,-60,0,-75,16,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125,1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,-127,-111,-95,8,35,66,-79,-63,21,82,-47,-16,36,51,98,114,-126,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,-125,-124,-123,-122,-121,-120,-119,-118,-110,-109,-108,-107,-106,-105,-104,-103,-102,-94,-93,-92,-91,-90,-89,-88,-87,-86,-78,-77,-76,-75,-74,-73,-72,-71,-70,-62,-61,-60,-59,-58,-57,-56,-55,-54,-46,-45,-44,-43,-42,-41,-40,-39,-38,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-1,-60,0,31,1,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,-1,-60,0,-75,17,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119,0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,-127,8,20,66,-111,-95,-79,-63,9,35,51,82,-16,21,98,114,-47,10,22,36,52,-31,37,-15,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,-126,-125,-124,-123,-122,-121,-120,-119,-118,-110,-109,-108,-107,-106,-105,-104,-103,-102,-94,-93,-92,-91,-90,-89,-88,-87,-86,-78,-77,-76,-75,-74,-73,-72,-71,-70,-62,-61,-60,-59,-58,-57,-56,-55,-54,-46,-45,-44,-43,-42,-41,-40,-39,-38,-30,-29,-28,-27,-26,-25,-24,-23,-22,-14,-13,-12,-11,-10,-9,-8,-7,-6,-1,-38,0,12,3,1,0,2,17,3,17,0,63,0,-1,0,63,-6,43,-46,-66,16,-4,28,-8,-85,-15,-1,0,-30,22,-117,-16,-89,-32,-81,-128,-4,69,-15,35,-30,23,-120,96,-41,46,-12,111,8,120,87,79,-109,80,-42,111,108,-68,57,-31,-3,87,-60,-2,33,-66,72,20,-123,-118,-57,66,-16,-10,-117,-86,-21,-70,-67,-12,-17,29,-90,-97,-92,-40,94,-33,-34,79,29,-76,50,-54,61,11,-30,-41,-20,-117,-5,78,124,6,-8,113,-16,-45,-30,-9,-58,63,-126,-66,53,-8,125,-16,-45,-29,11,106,35,-31,63,-114,-4,69,-89,-59,109,-31,-97,-120,-15,105,81,-57,46,-93,123,-32,-115,81,39,-106,15,19,105,-106,-80,-51,109,59,-22,-38,75,92,-23,109,111,121,-89,92,71,120,-16,-33,88,75,40,7,-50,116,87,-75,-4,58,-3,-100,62,61,-4,91,-16,7,-60,-1,0,-118,-33,14,62,20,120,-57,-59,31,12,-66,12,-40,-23,-102,-121,-59,-97,-119,54,90,76,-80,-4,63,-8,121,109,-84,-34,-59,-89,-24,-117,-30,-1,0,25,95,27,95,15,-24,-105,-102,-27,-12,-79,89,104,-70,109,-26,-93,30,-91,-86,-35,-55,29,-66,-101,107,113,51,5,60,63,-60,47,-121,62,62,-8,75,-30,-3,87,-64,31,19,-68,31,-81,-8,23,-58,-102,26,105,-110,107,62,20,-15,70,-103,117,-92,107,-6,90,106,-6,77,-122,-73,-91,27,-3,50,-14,56,-82,109,127,-76,52,-115,70,-61,83,-75,19,70,-83,45,-115,-35,-83,-54,-125,20,-88,-20,1,-58,81,69,20,1,-6,43,-1,0,4,-52,-8,-15,-5,32,126,-51,-33,30,117,-49,-118,31,-74,103,-121,62,62,124,71,-8,113,99,-32,-99,70,-62,-45,-32,119,-64,-17,-8,67,-76,-83,47,-29,-114,-81,37,-3,-122,-93,107,-16,-33,-29,-121,-115,60,73,-29,47,15,-22,62,29,-8,43,-85,-35,105,86,63,-16,-99,-24,-2,25,-47,-68,77,123,-29,29,55,119,-121,-75,-99,38,95,13,-66,-81,-92,106,31,-87,-70,-65,-4,21,-5,-10,28,-8,-29,-5,66,120,-109,-29,-41,-19,-107,-16,95,-30,-17,-57,-67,123,-60,-1,0,8,124,5,-16,-49,-61,-79,15,-123,-97,7,-12,-97,0,-2,-51,-2,24,63,27,52,123,-49,-120,95,9,-1,0,101,-1,0,-127,-102,-105,-58,77,115,-64,-34,2,-16,-65,-122,-1,0,103,61,1,62,24,124,38,-8,-76,117,40,-2,40,-1,0,-62,-46,-15,71,-113,126,49,-8,-105,77,-75,-69,-70,-48,-12,91,63,-26,118,-118,0,-2,-112,117,111,-8,43,95,-20,21,-15,71,-10,107,-8,1,-5,28,-4,77,-3,-104,62,47,-8,15,-10,93,-16,-33,-19,-19,-5,90,-2,-43,127,-76,31,-63,15,-127,-102,-121,-123,-4,59,-91,-4,70,-8,111,-15,62,-5,-58,90,-73,-20,-11,-32,127,15,-8,-97,78,-15,-25,-126,-81,-83,-11,-65,-125,-89,-59,54,94,21,-69,-77,-43,52,-72,-68,63,15,-122,-4,39,-31,59,-51,22,-2,-30,123,107,109,26,-41,15,-31,71,-4,20,-33,-2,9,-89,-16,-65,-10,120,-15,-18,-117,23,-20,109,-30,15,20,126,-46,62,49,-46,63,107,63,20,79,-15,11,-30,-73,-62,-33,-125,-65,29,-76,107,-17,-115,95,18,-4,74,-98,10,-3,-103,-81,-11,-113,23,124,95,-8,-127,-30,31,27,73,-16,-25,-10,119,-8,25,127,-30,61,90,79,9,69,105,37,-97,-120,-1,0,104,107,-19,15,-58,90,-106,-105,127,107,-96,88,-22,-14,127,59,84,80,1,69,20,80,1,69,20,80,1,69,20,80,1,69,20,80,7,-1,-39]";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_case3);
        ImageView iv = findViewById(R.id.iv);
//        //bitmap转String
        Bitmap bitmap = BitmapFactory.decodeResource(getResources(), R.mipmap.ic_launcher);
//        byte[] bytes = bmpToBytes(bitmap);
//        StringBuilder builder = new StringBuilder("[");
//        for (int i = 0; i < bytes.length; i++) {
//            if(i!=bytes.length-1){
//                builder.append(bytes[i]+",");
//            }else {
//                builder.append(bytes[i]+"]");
//            }
//        }
//        String[] strs = builder.toString().replace("[","").replace("]","").split(",");
//        byte[] newBytes = new byte[strs.length];
//        for (int i = 0; i < strs.length; i++) {
//            newBytes[i] = Byte.parseByte(strs[i]);
//        }
//        Bitmap bmp = BitmapFactory.decodeByteArray(newBytes, 0, newBytes.length);

        //String testStr = bmpToString(bitmap);
        Bitmap bmp = strToBitmap(test);
        iv.setImageBitmap(bmp);
    }

    /**
     * Bitmap转二进制字符串
     * @param bmp
     * @return
     */
    public static String bmpToString(Bitmap bmp){
        byte[] bytes = bmpToBytes(bmp);
        StringBuilder builder = new StringBuilder("[");
        for (int i = 0; i < bytes.length; i++) {
            if(i!=bytes.length-1){
                builder.append(bytes[i]+",");
            }else {
                builder.append(bytes[i]+"]");
            }
        }
        return builder.toString();
    }

    /**
     * 二进制字符串转Bitmap
     * @return
     */
    public static Bitmap strToBitmap(String str){
        String[] strs = str.replace("[","").replace("]","").split(",");
        byte[] newBytes = new byte[strs.length];
        for (int i = 0; i < strs.length; i++) {
            newBytes[i] = Byte.parseByte(strs[i]);
        }
        Bitmap bmp = BitmapFactory.decodeByteArray(newBytes, 0, newBytes.length);
        return bmp;
    }


    public static byte[] bmpToBytes(Bitmap bitmap){
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        bitmap.compress(Bitmap.CompressFormat.JPEG, 100, baos);
        byte[] datas = baos.toByteArray();
        return datas;
    }

}
